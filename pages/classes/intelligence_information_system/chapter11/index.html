<!DOCTYPE html>
<html lang="ja">
    <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    決定木 | mLAB
  </title>

  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/syntax.css">
  
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="mLAB" />

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kosugi&display=swap" rel="stylesheet">

  
  <script src="https://kit.fontawesome.com/0c97f11cd6.js" crossorigin="anonymous"></script>

  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/jquery.slicknav.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/slicknav.min.css" />

  
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v9.0"></script>  
  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
	     tex2jax: {
	        inlineMath: [['$','$']]
        }
    });
  </script>

  
  

  
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  
  
  

  <meta property="og:title" content="決定木" />



  <meta property="og:type" content="article" />



  <meta property="og:url" content="https://mukai-lab.info/pages/classes/intelligence_information_system/chapter11/" />



  <meta property="og:image" content="https://i.gyazo.com/0f765b0d1f5517f2690a081f53e94bd5.png" />



  <meta property="og:site_name" content="mLAB" />



  <meta property="og:description" content="ノートブックの作成 Colabにアクセスし，新規にノートブックを作成してください． ノートブックのタイトルは chapter11 とします．
最初にグラフで日本語表示を可能とするjapanize-matplotlibをインストールします．
!pip install japanize-matplotlib また，numpy，matplotlib.pyplot ，scikit-learn に加えて， データフレームを処理するための Pandasをインポートします．
import numpy as np import matplotlib.pyplot as plt from sklearn import tree from sklearn.tree import plot_tree import pandas as pd import japanize_matplotlib データの準備 今回は，曜日（平日 or 土日） ， 時間帯（昼 or 夜） ，価格（高 or 安）， 天気（晴 or 雨） の情報を利用して， イベントの 来場者数（多 or 少） を分類（予測）してみましょう． 学習用のデータには15のサンプルが含まれています． また，学習用のデータの表現のため，データフレーム（Excelの表のようなもの）を利用します． これまでの行列とは異なり，データフレームには 属性名（列名） を設定することが可能です．
[In:]
df = pd.DataFrame( { &#34;曜日&#34;: [&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;土日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;土日&#34;], &#34;時間帯&#34;:[&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;], &#34;価格&#34;:[&#34;安&#34;,&#34;安&#34;,&#34;高&#34;,&#34;高&#34;,&#34;高&#34;,&#34;高&#34;,&#34;安&#34;,&#34;高&#34;,&#34;安&#34;,&#34;高&#34;,&#34;高&#34;,&#34;安&#34;,&#34;安&#34;,&#34;高&#34;,&#34;安&#34;], &#34;天気&#34;:[&#34;晴&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,], &#34;来場者数&#34;:[&#34;多&#34;,&#34;多&#34;,&#34;少&#34;,&#34;多&#34;,&#34;多&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,] } ) display(df) 決定木の生成には，機械学習のライブラリである scikit-learn を利用しますが， &ldquo;平日&quot;や&quot;&ldquo;土日&quot;などの 質的変数 を扱うことができないため，上記のデータフレームを ダミー変数 に変換する必要があります（R言語の rpart なら質的変数のままでも可能）． ダミー変数とは，文字列などの質的変数を，量的変数（数値） で表したものです． 例えば &ldquo;平日&quot;を&quot;1&rdquo;，&ldquo;土日&quot;を&quot;0&quot;として表します． ダミー変数への変換は，Pandasの get_dummies 関数を用いるだけです（多重共線性を避けるため drop_first=True を設定しています）．" />



  
  
<meta name="twitter:card" content="summary" />

<meta name="twitter:site" content="@nmukai1978" />


  <meta name="twitter:title" content="決定木" />



  <meta name="twitter:description" content="ノートブックの作成 Colabにアクセスし，新規にノートブックを作成してください． ノートブックのタイトルは chapter11 とします．
最初にグラフで日本語表示を可能とするjapanize-matplotlibをインストールします．
!pip install japanize-matplotlib また，numpy，matplotlib.pyplot ，scikit-learn に加えて， データフレームを処理するための Pandasをインポートします．
import numpy as np import matplotlib.pyplot as plt from sklearn import tree from sklearn.tree import plot_tree import pandas as pd import japanize_matplotlib データの準備 今回は，曜日（平日 or 土日） ， 時間帯（昼 or 夜） ，価格（高 or 安）， 天気（晴 or 雨） の情報を利用して， イベントの 来場者数（多 or 少） を分類（予測）してみましょう． 学習用のデータには15のサンプルが含まれています． また，学習用のデータの表現のため，データフレーム（Excelの表のようなもの）を利用します． これまでの行列とは異なり，データフレームには 属性名（列名） を設定することが可能です．
[In:]
df = pd.DataFrame( { &#34;曜日&#34;: [&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;土日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;平日&#34;,&#34;土日&#34;], &#34;時間帯&#34;:[&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;,&#34;昼&#34;,&#34;夜&#34;,&#34;昼&#34;], &#34;価格&#34;:[&#34;安&#34;,&#34;安&#34;,&#34;高&#34;,&#34;高&#34;,&#34;高&#34;,&#34;高&#34;,&#34;安&#34;,&#34;高&#34;,&#34;安&#34;,&#34;高&#34;,&#34;高&#34;,&#34;安&#34;,&#34;安&#34;,&#34;高&#34;,&#34;安&#34;], &#34;天気&#34;:[&#34;晴&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;晴&#34;,&#34;雨&#34;,&#34;晴&#34;,&#34;晴&#34;,], &#34;来場者数&#34;:[&#34;多&#34;,&#34;多&#34;,&#34;少&#34;,&#34;多&#34;,&#34;多&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;少&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,&#34;多&#34;,] } ) display(df) 決定木の生成には，機械学習のライブラリである scikit-learn を利用しますが， &ldquo;平日&quot;や&quot;&ldquo;土日&quot;などの 質的変数 を扱うことができないため，上記のデータフレームを ダミー変数 に変換する必要があります（R言語の rpart なら質的変数のままでも可能）． ダミー変数とは，文字列などの質的変数を，量的変数（数値） で表したものです． 例えば &ldquo;平日&quot;を&quot;1&rdquo;，&ldquo;土日&quot;を&quot;0&quot;として表します． ダミー変数への変換は，Pandasの get_dummies 関数を用いるだけです（多重共線性を避けるため drop_first=True を設定しています）．" />



  <meta name="twitter:image" content="https://i.gyazo.com/0f765b0d1f5517f2690a081f53e94bd5.png" />


  
</head>

    <body>
        <nav class="nav">
  <div class="nav-container">
    
    <a href="/">
    <h2 class="nav-title">
      <img src="https://mukai-lab.info/favicon/favicon-48x48.png" align="top"/>
      <span>mLAB</span>
      

<ul id="menu">
  
  
  <li>
    <a href="/">Top</a>
  </li>
  
  
  
  <li>
    <a href="/classes/">Classes</a>
  </li>
  
  
  
  <li>
    <a href="/posts/">Comics</a>
  </li>
  
  
</ul>

<script>
  $(function(){
    $("#menu").slicknav({
      label: "メニュー"
    });
  });
</script>



    </h2>
    </a>
  </div>
</nav>

        <div id="darkModeToggle" onclick="toggleDarkMode()">
  &#9680; 
</div>

        

<main>
  <div class="post">
    
    <h1 class="post-title">決定木</h1>
<div class="post-line"></div>
    
    

    <p><a href="https://gyazo.com/0f765b0d1f5517f2690a081f53e94bd5"><img src="https://i.gyazo.com/0f765b0d1f5517f2690a081f53e94bd5.png" alt="Image from Gyazo"></a></p>
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  ノートブックの作成
</h1>

<p>Colabにアクセスし，新規にノートブックを作成してください．
ノートブックのタイトルは <strong>chapter11</strong> とします．</p>
<p>最初にグラフで日本語表示を可能とする<a href="https://pypi.org/project/japanize-matplotlib/">japanize-matplotlib</a>をインストールします．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install japanize<span style="color:#f92672">-</span>matplotlib
</span></span></code></pre></div><p>また，<strong>numpy</strong>，<strong>matplotlib.pyplot</strong> ，<strong>scikit-learn</strong> に加えて，
データフレームを処理するための <a href="https://pandas.pydata.org/">Pandas</a>をインポートします．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> tree
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> plot_tree
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> japanize_matplotlib
</span></span></code></pre></div><h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  データの準備
</h1>

<p>今回は，<strong>曜日（平日 or 土日）</strong> ， <strong>時間帯（昼 or 夜）</strong> ，<strong>価格（高 or 安）</strong>， <strong>天気（晴 or 雨）</strong> の情報を利用して，
イベントの <strong>来場者数（多 or 少）</strong> を分類（予測）してみましょう．
学習用のデータには15のサンプルが含まれています．
また，学習用のデータの表現のため，データフレーム（Excelの表のようなもの）を利用します．
これまでの行列とは異なり，データフレームには <strong>属性名（列名）</strong> を設定することが可能です．</p>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;曜日&#34;</span>: [<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;土日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;平日&#34;</span>,<span style="color:#e6db74">&#34;土日&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;時間帯&#34;</span>:[<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>,<span style="color:#e6db74">&#34;夜&#34;</span>,<span style="color:#e6db74">&#34;昼&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;価格&#34;</span>:[<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>,<span style="color:#e6db74">&#34;高&#34;</span>,<span style="color:#e6db74">&#34;安&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;天気&#34;</span>:[<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;雨&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;雨&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;雨&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;雨&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,<span style="color:#e6db74">&#34;晴&#34;</span>,],
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;来場者数&#34;</span>:[<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;少&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,<span style="color:#e6db74">&#34;多&#34;</span>,]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>display(df)
</span></span></code></pre></div><p><a href="https://gyazo.com/7fc357fb695455c04c00ee94dd52afac"><img src="https://i.gyazo.com/7fc357fb695455c04c00ee94dd52afac.png" alt="Image from Gyazo"></a></p>
<p>決定木の生成には，機械学習のライブラリである <a href="https://scikit-learn.org/stable/">scikit-learn</a> を利用しますが，
&ldquo;平日&quot;や&quot;&ldquo;土日&quot;などの <strong>質的変数</strong> を扱うことができないため，上記のデータフレームを <strong>ダミー変数</strong> に変換する必要があります（R言語の <strong>rpart</strong> なら質的変数のままでも可能）．
ダミー変数とは，文字列などの質的変数を，<strong>量的変数（数値）</strong> で表したものです．
例えば &ldquo;平日&quot;を&quot;1&rdquo;，&ldquo;土日&quot;を&quot;0&quot;として表します．
ダミー変数への変換は，Pandasの <strong>get_dummies</strong> 関数を用いるだけです（多重共線性を避けるため <strong>drop_first=True</strong> を設定しています）．</p>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#34;曜日&#34;</span>,<span style="color:#e6db74">&#34;時間帯&#34;</span>,<span style="color:#e6db74">&#34;価格&#34;</span>,<span style="color:#e6db74">&#34;天気&#34;</span>]]
</span></span><span style="display:flex;"><span>target <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;来場者数&#34;</span>]
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(data, drop_first<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>) <span style="color:#75715e">#ダミー変数の生成</span>
</span></span><span style="display:flex;"><span>target <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(target, drop_first<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>display(data)
</span></span><span style="display:flex;"><span>display(target)
</span></span></code></pre></div><p><a href="https://gyazo.com/f47dceec89e1884ddbca6a16e324c300"><img src="https://i.gyazo.com/f47dceec89e1884ddbca6a16e324c300.png" alt="Image from Gyazo"></a></p>
<p><a href="https://gyazo.com/560ebf1aad9073df5cb64970ad824608"><img src="https://i.gyazo.com/560ebf1aad9073df5cb64970ad824608.png" alt="Image from Gyazo"></a></p>
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  決定木のアルゴリズム
</h1>

<p>それでは， 今回のテーマである <strong>決定木</strong> について考えていきましょう．
決定木は，これまでに紹介したロジスティック回帰やK近傍法のように分類（予測）のための手法です．
分類のプロセスが <strong>木構造</strong> で表されることから，その名前が付けられました．
決定木を生成するためには，<strong>ID3</strong>，<strong>C4.5</strong>，<strong>CART</strong> などのアルゴリズムが提案されています．
これらのアルゴリズムは，<strong>エントロピー（平均情報量）</strong> や <strong>ジニ係数</strong> を基準に，
サンプルの分割することを繰り返すことで，木構造を形成するという特徴を持ちます．
ここでは，エントロピーを利用した，サンプルの分割に関して解説します．</p>
<h3 id="情報量">情報量</h3>
<p><strong>情報量</strong> とは，ある事象が起こった際の，起こりにくさを表す尺度です．
事象を$E$，その事象が発生する確率を$P(E)$とすると，下記の式で情報量$I(E)$を求めることができます（対数の底は$2$とすることが多いです）．</p>
<p>$$I(E) = \log_2\left( \frac{1}{P(E)} \right) = - \log_2( P(E) )$$</p>
<p>例えば，いびつな形のサイコロを考えてみましょう．
このサイコロは，1の目が出やすく，他の2,3,4,5,6の目は出にくいという特殊な形状だとします（確率は表に記載）．
ここで，1の目が出る情報量を求めると，</p>
<p>$$I(1の目) = - \log_2( P(1の目) ) =  - \log_2( 0.5 ) = 1$$</p>
<p>また，2の目が出る情報量を求めると，</p>
<p>$$I(2の目) = - \log_2( P(2の目) ) =  - \log_2( 0.1 ) = 3.32$$</p>
<p>となります．
このように，めったに起こることがない事象は情報量が <strong>大きく</strong>，
頻繁に起こる事象は情報量が <strong>小さく</strong> なるという特徴を持ちます．</p>
<table>
<thead>
<tr>
<th>事象$E$（サイコロの目）</th>
<th>確率$P(E)$</th>
<th>情報量$I(E)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.5</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>0.1</td>
<td>3.32</td>
</tr>
<tr>
<td>3</td>
<td>0.1</td>
<td>3.32</td>
</tr>
<tr>
<td>4</td>
<td>0.1</td>
<td>3.32</td>
</tr>
<tr>
<td>5</td>
<td>0.1</td>
<td>3.32</td>
</tr>
<tr>
<td>6</td>
<td>0.1</td>
<td>3.32</td>
</tr>
</tbody>
</table>
<h3 id="平均情報量エントロピー">平均情報量（エントロピー）</h3>
<p><strong>平均情報量（エントロピー）</strong> とは，上記の <strong>情報量</strong> の期待値（平均値）です．
確率変数（サイコロ）を$X$，結果として起こりうる事象（1,2,3,4,5,6の目）を$E_i$とすると，下記の式でエントロピー$H(X)$を求めることができます．</p>
<p>$$H(X) = \sum_{E_i} P(E_i) \cdot I(E_i)$$</p>
<p>例えば，上記のサイコロの例で，エントロピーを求めると，</p>
<p>$$H(サイコロ) = P(1の目) \cdot I(1の目) + \cdots + P(6の目) \cdot I(6の目) $$</p>
<p>$$H(サイコロ) = 0.5 \cdot 1 + (0.1 \cdot 3.32) \times 5 = 2.16$$</p>
<p>となります．
エントロピーは，事象の発生確率が，均一であるほど <strong>大きく</strong>,
偏りがあるほど <strong>小さく</strong> なるという特徴を持ちます．</p>
<h3 id="データセット分割前のエントロピー">データセット（分割前）のエントロピー</h3>
<p>それでは，来場者数のデータセットのエントロピーを計算してみましょう．
15のサンプルにおいて，来場者が多となる確率は $9 / 15$ ，少となる確率は $6 / 15$ です．
この確率を基にエントロピーを計算すると$0.97$となります．</p>
<table>
<thead>
<tr>
<th>事象$E$（来場者数）</th>
<th>確率$P(E)$</th>
<th>情報量$I(E)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>多</td>
<td>9 / 15</td>
<td>0.74</td>
</tr>
<tr>
<td>少</td>
<td>6 / 15</td>
<td>1.32</td>
</tr>
</tbody>
</table>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#75715e">#エントロピーの定義</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">entropy</span>(probs):
</span></span><span style="display:flex;"><span>    value <span style="color:#f92672">=</span> (probs <span style="color:#f92672">*</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log2(probs))<span style="color:#f92672">.</span>sum()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#分割前のエントロピー</span>
</span></span><span style="display:flex;"><span>probs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">9</span><span style="color:#f92672">/</span><span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span><span style="color:#f92672">/</span><span style="color:#ae81ff">15</span>])
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> entropy(probs)
</span></span><span style="display:flex;"><span>print(e)
</span></span></code></pre></div><p><strong>[Out:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>0.9709505944546686
</span></span></code></pre></div><h3 id="データセット分割後のエントロピー">データセット（分割後）のエントロピー</h3>
<p>ここでは，<strong>価格</strong> でデータセットを分割してみましょう．
価格が <strong>高</strong> は8サンプル，<strong>安</strong> は7サンプルとなります．</p>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>high <span style="color:#f92672">=</span> data[data[<span style="color:#e6db74">&#34;価格_高&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>low <span style="color:#f92672">=</span> data[data[<span style="color:#e6db74">&#34;価格_高&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_high <span style="color:#f92672">=</span> target<span style="color:#f92672">.</span>loc[high<span style="color:#f92672">.</span>index]
</span></span><span style="display:flex;"><span>display(target_high)
</span></span><span style="display:flex;"><span>target_low <span style="color:#f92672">=</span> target<span style="color:#f92672">.</span>loc[low<span style="color:#f92672">.</span>index]
</span></span><span style="display:flex;"><span>display(target_low)
</span></span></code></pre></div><p><a href="https://gyazo.com/a5c71bbf0a4c90dfc544e4f9c71895e2"><img src="https://i.gyazo.com/a5c71bbf0a4c90dfc544e4f9c71895e2.png" alt="Image from Gyazo"></a></p>
<p><a href="https://gyazo.com/7a54e33f42ec9a5e023bd154965a53d1"><img src="https://i.gyazo.com/7a54e33f42ec9a5e023bd154965a53d1.png" alt="Image from Gyazo"></a></p>
<p>分割したそれぞれのデータセットで，エントロピーを計算すると，
高のエントロピーは $1.00$，安のエントロピーは $0.86$ となりました．</p>
<p><strong>(価格=高)</strong></p>
<table>
<thead>
<tr>
<th>事象$E$（来場者数）</th>
<th>確率$P(E)$</th>
<th>情報量$I(E)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>多</td>
<td>4 / 8</td>
<td>1</td>
</tr>
<tr>
<td>少</td>
<td>4 / 8</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>(価格=安)</strong></p>
<table>
<thead>
<tr>
<th>事象$E$（来場者数）</th>
<th>確率$P(E)$</th>
<th>情報量$I(E)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>多</td>
<td>5 / 7</td>
<td>0.49</td>
</tr>
<tr>
<td>少</td>
<td>2 / 7</td>
<td>1.80</td>
</tr>
</tbody>
</table>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#75715e">#分割後（価格_高）のエントロピー</span>
</span></span><span style="display:flex;"><span>probs_high <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>])
</span></span><span style="display:flex;"><span>e_high <span style="color:#f92672">=</span> entropy(probs_high)
</span></span><span style="display:flex;"><span>print(e_high)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#分割後（価格_低）のエントロピー</span>
</span></span><span style="display:flex;"><span>probs_low <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">/</span><span style="color:#ae81ff">7</span>])
</span></span><span style="display:flex;"><span>e_low <span style="color:#f92672">=</span> entropy(probs_low)
</span></span><span style="display:flex;"><span>print(e_low)
</span></span></code></pre></div><p><strong>[Out:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>1.0
</span></span><span style="display:flex;"><span>0.863120568566631
</span></span></code></pre></div><p>このエントロピーの期待値を求め，分割前のエントロピーとの差を計算すると$0.035$となります．
この値は <strong>情報利得（Information Gain）</strong> と呼ばれ，分割後のデータが偏るほど（不純度が減ると），大きな値となります．
例えば，分割後のデータセットが，全て&quot;多&rdquo;，または，全て&quot;少&quot;となるとき，情報利得は最大となります．
全ての属性（曜日，時間帯，価格，天気）の情報利得を調べると，下記の表のようになり，
最も値の大きい <strong>価格</strong> が分割のための基準として採用されます．
この操作を繰り返すことで，決定木が生成されます．</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>情報利得</th>
</tr>
</thead>
<tbody>
<tr>
<td>曜日</td>
<td>0.005</td>
</tr>
<tr>
<td>時間帯</td>
<td>0.009</td>
</tr>
<tr>
<td>価格</td>
<td>0.035</td>
</tr>
<tr>
<td>天気</td>
<td>0.011</td>
</tr>
</tbody>
</table>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#75715e">#情報利得の定義</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gain</span>(data, target, attr):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    probs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([target<span style="color:#f92672">.</span>sum() <span style="color:#f92672">/</span> len(target), (len(target) <span style="color:#f92672">-</span> target<span style="color:#f92672">.</span>sum()) <span style="color:#f92672">/</span> len(target)])
</span></span><span style="display:flex;"><span>    e <span style="color:#f92672">=</span> entropy(probs) <span style="color:#75715e">#分割前のエントロピー</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> data[data[attr] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> data[data[attr] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    target_t <span style="color:#f92672">=</span> target<span style="color:#f92672">.</span>loc[t<span style="color:#f92672">.</span>index]
</span></span><span style="display:flex;"><span>    target_f <span style="color:#f92672">=</span> target<span style="color:#f92672">.</span>loc[f<span style="color:#f92672">.</span>index]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    probs_t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([target_t<span style="color:#f92672">.</span>sum() <span style="color:#f92672">/</span> len(target_t),  (len(target_t) <span style="color:#f92672">-</span> target_t<span style="color:#f92672">.</span>sum()) <span style="color:#f92672">/</span> len(target_t)])
</span></span><span style="display:flex;"><span>    probs_f <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([target_f<span style="color:#f92672">.</span>sum() <span style="color:#f92672">/</span> len(target_f),  (len(target_f) <span style="color:#f92672">-</span> target_f<span style="color:#f92672">.</span>sum()) <span style="color:#f92672">/</span> len(target_f)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    e_t <span style="color:#f92672">=</span> entropy(probs_t) <span style="color:#75715e">#分割後のエントロピー</span>
</span></span><span style="display:flex;"><span>    e_f <span style="color:#f92672">=</span> entropy(probs_f)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> e <span style="color:#f92672">-</span> ((len(t) <span style="color:#f92672">/</span> len(data)) <span style="color:#f92672">*</span> e_t <span style="color:#f92672">+</span> (len(f) <span style="color:#f92672">/</span> len(data)) <span style="color:#f92672">*</span> e_f) <span style="color:#75715e">#情報利得</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> g
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g_price <span style="color:#f92672">=</span> gain(data, target, <span style="color:#e6db74">&#34;曜日_平日&#34;</span>)
</span></span><span style="display:flex;"><span>print(g_price)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g_price <span style="color:#f92672">=</span> gain(data, target, <span style="color:#e6db74">&#34;時間帯_昼&#34;</span>)
</span></span><span style="display:flex;"><span>print(g_price)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g_price <span style="color:#f92672">=</span> gain(data, target, <span style="color:#e6db74">&#34;価格_高&#34;</span>)
</span></span><span style="display:flex;"><span>print(g_price)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g_price <span style="color:#f92672">=</span> gain(data, target, <span style="color:#e6db74">&#34;天気_雨&#34;</span>)
</span></span><span style="display:flex;"><span>print(g_price)
</span></span></code></pre></div><p><strong>[Out:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">0.004545537028176172</span> <span style="color:#75715e">#曜日_平日</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.008986624929939513</span> <span style="color:#75715e">#時間帯_昼</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.03482766245690749</span> <span style="color:#75715e">#価格_高</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.010799704414199196</span> <span style="color:#75715e">#天気_雨</span>
</span></span></code></pre></div><h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  scikit-learnで決定木
</h1>

<p>それでは，機械学習のライブラリである <a href="https://scikit-learn.org/stable/">scikit-learn</a> を利用して決定木を生成してみましょう．
scikit-learnでは， <strong>CART</strong> と呼ばれるアルゴリズムで決定木を生成します．
また， 分割の基準として標準では <strong>ジニ係数</strong> が用いられますが，ここでは上記で説明した <strong>エントロピー</strong> を利用します．
決定木の生成には <strong>tree.DecisionTreeClassifier</strong> 関数を用います．
ここで，基準（criterion）を <strong>entropy</strong> ，木の最大の深さ（max_depth）を <strong>3</strong> ，
乱数のシード（random_state）を <strong>0</strong> に固定しています．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>t <span style="color:#f92672">=</span> tree<span style="color:#f92672">.</span>DecisionTreeClassifier(criterion<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;entropy&#34;</span>, max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> t<span style="color:#f92672">.</span>fit(data, target)
</span></span></code></pre></div><p>生成された決定木を<code>plt_tree</code>で可視化します．
<code>figsize</code>はグラフの大きさを設定しています．</p>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>plot_tree(t, feature_names<span style="color:#f92672">=</span>data<span style="color:#f92672">.</span>columns, filled<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>下図が生成された決定木です．
決定木の根（ルート）から，属性に基づき分類し，最終的に到達する葉（リーフ）で <strong>多(0)</strong> か <strong>少(1)</strong> かを判定します．
例えば，<strong>価格_高 &lt;= 0.5</strong> は，チケット価格（価格_高）による分類であり，<strong>True</strong> は安(0)，<strong>False</strong>　は高(1)を表しています．
例えば，価格が安く（価格_高 &lt;= 0.5がTrue），お昼に開催される（時間帯_昼 &gt; 0.5がFalse）ときは，来場者は <strong>多</strong> となることがわかります．</p>
<p><a href="https://gyazo.com/67e8e7a51d55afa1ff4623613b4dfa6f"><img src="https://i.gyazo.com/67e8e7a51d55afa1ff4623613b4dfa6f.png" alt="Image from Gyazo"></a></p>
<p>最後に，<strong>predict</strong> 関数を利用して，決定木に対数する入力と出力の関係を確認します．
例えば，「平日（1），昼（1），安（0），晴（0）」を入力すると，来場者数の予測は「多（0）」という結果が得られます．</p>
<p><strong>[In:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>result <span style="color:#f92672">=</span> t<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]) <span style="color:#75715e">#平日，昼，安，晴</span>
</span></span><span style="display:flex;"><span>print(result) <span style="color:#75715e">#多</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> t<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]) <span style="color:#75715e">#平日，夜，安，晴</span>
</span></span><span style="display:flex;"><span>print(result) <span style="color:#75715e">#多</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> t<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]]) <span style="color:#75715e">#平日，昼，高，晴</span>
</span></span><span style="display:flex;"><span>print(result) <span style="color:#75715e">#少</span>
</span></span></code></pre></div><p><strong>[Out:]</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>[0]
</span></span><span style="display:flex;"><span>[0]
</span></span><span style="display:flex;"><span>[1]
</span></span></code></pre></div><h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  課題
</h1>

<p>タイタニックの<a href="https://www.kaggle.com/c/titanic">データセット</a>を利用して，
生存結果（0:死亡，1:生存）を分類するための決定木を作成してください．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;生存結果&#39;</span>: {<span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">13</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">16</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">17</span>: <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">18</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">19</span>: <span style="color:#ae81ff">1</span>}, 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;階級&#39;</span>: {<span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>: <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">13</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">15</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">16</span>: <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">17</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">18</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">19</span>: <span style="color:#ae81ff">3</span>}, 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;性別&#39;</span>: {<span style="color:#ae81ff">0</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">1</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">2</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">3</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">4</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">5</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">6</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">7</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">8</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">9</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">10</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">11</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">12</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">13</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">14</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">15</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">16</span>: <span style="color:#e6db74">&#39;female&#39;</span>, <span style="color:#ae81ff">17</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">18</span>: <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#ae81ff">19</span>: <span style="color:#e6db74">&#39;female&#39;</span>}, 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;年齢&#39;</span>: {<span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>: <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>: <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">11</span>: <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>: <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">13</span>: <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">14</span>: <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">15</span>: <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">16</span>: <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">17</span>: <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">18</span>: <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">19</span>: <span style="color:#ae81ff">15</span>}, 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;乗船料金&#39;</span>: {<span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">7.25</span>, <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">71.2833</span>, <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">7.925</span>, <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">53.1</span>, <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">8.05</span>, <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">51.8625</span>, <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">21.075</span>, <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">11.1333</span>, <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">30.0708</span>, <span style="color:#ae81ff">9</span>: <span style="color:#ae81ff">16.7</span>, <span style="color:#ae81ff">10</span>: <span style="color:#ae81ff">26.55</span>, <span style="color:#ae81ff">11</span>: <span style="color:#ae81ff">8.05</span>, <span style="color:#ae81ff">12</span>: <span style="color:#ae81ff">31.275</span>, <span style="color:#ae81ff">13</span>: <span style="color:#ae81ff">7.8542</span>, <span style="color:#ae81ff">14</span>: <span style="color:#ae81ff">16.0</span>, <span style="color:#ae81ff">15</span>: <span style="color:#ae81ff">29.125</span>, <span style="color:#ae81ff">16</span>: <span style="color:#ae81ff">18.0</span>, <span style="color:#ae81ff">17</span>: <span style="color:#ae81ff">26.0</span>, <span style="color:#ae81ff">18</span>: <span style="color:#ae81ff">13.0</span>, <span style="color:#ae81ff">19</span>: <span style="color:#ae81ff">8.0292</span>}
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>課題を完成させたら，<strong>chapter11.ipynb</strong> を保存し，
<strong>共有用のリンク</strong> と <strong>ノートブック（.ipynb）</strong> をダウンロードして提出してください．
このとき，必ず事前に下記の設定を行ってから提出してください．</p>
<ul>
<li>ノートブックの設定で「セルの出力を除外する」のチェックを外す</li>
<li>ノートブックの変更内容を保存して固定</li>
<li>共有設定で「学校法人椙山女学園大学」を「閲覧者」に設定</li>
</ul>
<!-- <h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  課題
</h1>
 -->
<!-- scikit-learnの **アヤメ** のデータセットを決定木で分類してください． -->
<!-- dotファイルに変換する際は，feature_namesに **iris.feature_names**， -->
<!-- class_namesに **iris.target_names** を指定すること． -->
<!-- ```python -->
<!-- from sklearn.datasets import load_iris -->
<!-- iris = load_iris() -->
<!-- data = pd.DataFrame(iris.data) -->
<!-- data.columns=iris.feature_names -->
<!-- target = pd.DataFrame(iris.target) -->
<!-- target.columns=["label"] -->
<!-- print(data) -->
<!-- print(target) -->
<!-- ``` -->
<!-- [![Image from Gyazo](https://i.gyazo.com/de05cb6cd9a4c85c635506e7413358b6.png)](https://gyazo.com/de05cb6cd9a4c85c635506e7413358b6) -->
<!-- 作成したノートブックを **HTML(.html)** 形式でダウンロードし提出しなさい． -->

<h3>参考書籍</h3>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4274222446&linkId=1a63210b6dc95e90156695289116cb1b&bc1=f8f8f8&lt1=_blank&fc1=333333&lc1=0066c0&bg1=f8f8f8&f=ifr">
</iframe>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=tf_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=B078767Y56&linkId=cd73876214aec3d9b72777ab73920051&bc1=f8f8f8&lt1=_blank&fc1=333333&lc1=0066c0&bg1=f8f8f8&f=ifr">
</iframe>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=tf_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4802611641&linkId=e77970ab2740fac9fdeb8b877668c257&bc1=f8f8f8&lt1=_blank&fc1=333333&lc1=0066c0&bg1=f8f8f8&f=ifr">
</iframe>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=tf_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4839963525&linkId=14f05f671ddd917b204596b6b535981e&bc1=f8f8f8&lt1=_blank&fc1=333333&lc1=0066c0&bg1=f8f8f8&f=ifr">
</iframe>



    

    
    <div id="sns-box" style="display:flex; justify-content:center; align-items: center;">

  <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-via="nmukai1978" data-hashtags="mlab" data-dnt="true" data-show-count="false"></a>
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

  <div class="fb-share-button" data-href="https://mukai-lab.info/pages/classes/intelligence_information_system/chapter11/" data-layout="button" data-size="small"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmukai-lab.info%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">シェア</a></div>
    
</div>


    <div class="pagination">
      <a href="/"><span>Top</span></a>
      <a href='javascript:history.back()' style="margin-left: 30px"><span>Back</span></a>
    </div>
    
  </div>

  
  <div>

  <div style="margin-top:20px; border-top: solid 10px #007B50; border-bottom: solid 10px #007B50;">
    <p>
      愛知県名古屋市にある椙山女学園大学 文化情報学部 向研究室の公式サイトです．
      専門は情報科学であり，人工知能やデータベースなどの技術要素を指導しています．
      この公式サイトでは，授業で使用している教材を公開すると共に，
      ベールに包まれた女子大教員のミステリアスな日常を４コマ漫画でお伝えしていきます．
      サイトに関するご意見やご質問は<a href="https://www.facebook.com/nmukai1978">Facebook</a>または<a href="https://twitter.com/nmukai1978">Twitter</a>でお問い合わせください．
    </p>
  </div>  

</div>

  
  
  

    
  

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-77390013-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</main>


        <footer>
  <div>
    <span>&copy; 2016 Naoto Mukai All Rights Reserved.</span> 
  </div>
</footer>


    </body>
</html>
