<!DOCTYPE html>
<html lang="ja">
    <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    独立な2群のt検定 | MLAB
  </title>

  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/syntax.css">
  
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="MLAB" />

  
  <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c:500&amp;subset=japanese" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed" rel="stylesheet">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/jquery.slicknav.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/slicknav.min.css" />

  
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v3.3"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
	     tex2jax: {
	        inlineMath: [['$','$']]
        }
    });
  </script>

  
  

  <meta property="og:title" content="独立な2群のt検定" />



  <meta property="og:type" content="article" />



  <meta property="og:url" content="https://mukai-lab.info/pages/classes/advanced_studies_seminar_2/chapter11/" />



  <meta property="og:image" content="https://i.gyazo.com/63ddd77d5b31e97fd199a7706d1f3c60.png" />



  <meta property="og:site_name" content="MLAB" />



  <meta property="og:description" content="平均値差の検定とは -- 平均値差の検定とはこれまでは，母集団Xと標本xの関係に注目して検定を行いました． これからは，２つの標本（標本x_1，標本x_2）の関係に注目し， それぞれの平均値の有意な差があるかどうかを検定します． ２つの標本を検定する場合，下記の条件によって適用する手法が異なります．
 独立な2群（対応のない2群） 対応のある2群  独立な2群（対応のない2群）とは，ある母集団から２つの標本を抽出したとき， それぞれの標本に含まれる対象が互いに無関係であることを意味しています． 例えば，下記のように，母集団Xから8人の被験者を抽出して， これをランダムに4人の2群に分けた場合は，「独立な2群」です．
x_1 = \{a,b,c,d\} \\ x_2 = \{e,f,g,h\}  一方，対応のある2群 とは，2つの標本に含まれる対象に，何らかの対応関係があることを意味しています． 例えば，下記のように，同じ4人の被験者に対して，2種類の条件下で測定された2群のデータは，「対応のある2群」です．
条件1: x_1 = \{a,b,c,d\} \\ 条件2: x_2 = \{a&#39;,b&#39;,c&#39;,d&#39;\}  今回は，前者の独立な2群（対応のない2群）のt検定を解説します．
スクリプトの作成 -- スクリプトの作成コードを入力し保存するためのスクリプトを作成しましょう． [ファイル]-[新しいスクリプト]をクリックし，Rエディタを表示します． 次に，[ファイル]-[保存]をクリックして，スクリプトを保存します． このとき，ファイル名はchapter11としてください． また，ファイルの保存場所と作業ディレクトリをデスクトップに変更しておきます．
t検定の前提条件 -- t検定の前提条件独立な2群の平均値差の検定にもt検定を利用します． ただし，t検定を適用するには，下記の条件を満たす必要があります．
 ランダムサンプリングにより標本が抽出されている 母集団の分布が正規分布である 母集団の分散が等質である  上記の条件1，2はこれまでの前提と同じですが，条件3が新しく追加されました． もし，条件3を満たさない場合は，t検定の代わりに，Welchの検定 を利用する必要があります． Welchの検定に関しては割愛します． ここでは，上記の全ての条件を満たしていると仮定して話を進めます．
独立な2群のt検定 -- 独立な2群のt検定それでは，下記の問題について考えていきましょう．" />



  
  
<meta name="twitter:card" content="summary" />

<meta name="twitter:site" content="@nmukai1978" />


  <meta name="twitter:title" content="独立な2群のt検定" />



  <meta name="twitter:description" content="平均値差の検定とは -- 平均値差の検定とはこれまでは，母集団Xと標本xの関係に注目して検定を行いました． これからは，２つの標本（標本x_1，標本x_2）の関係に注目し， それぞれの平均値の有意な差があるかどうかを検定します． ２つの標本を検定する場合，下記の条件によって適用する手法が異なります．
 独立な2群（対応のない2群） 対応のある2群  独立な2群（対応のない2群）とは，ある母集団から２つの標本を抽出したとき， それぞれの標本に含まれる対象が互いに無関係であることを意味しています． 例えば，下記のように，母集団Xから8人の被験者を抽出して， これをランダムに4人の2群に分けた場合は，「独立な2群」です．
x_1 = \{a,b,c,d\} \\ x_2 = \{e,f,g,h\}  一方，対応のある2群 とは，2つの標本に含まれる対象に，何らかの対応関係があることを意味しています． 例えば，下記のように，同じ4人の被験者に対して，2種類の条件下で測定された2群のデータは，「対応のある2群」です．
条件1: x_1 = \{a,b,c,d\} \\ 条件2: x_2 = \{a&#39;,b&#39;,c&#39;,d&#39;\}  今回は，前者の独立な2群（対応のない2群）のt検定を解説します．
スクリプトの作成 -- スクリプトの作成コードを入力し保存するためのスクリプトを作成しましょう． [ファイル]-[新しいスクリプト]をクリックし，Rエディタを表示します． 次に，[ファイル]-[保存]をクリックして，スクリプトを保存します． このとき，ファイル名はchapter11としてください． また，ファイルの保存場所と作業ディレクトリをデスクトップに変更しておきます．
t検定の前提条件 -- t検定の前提条件独立な2群の平均値差の検定にもt検定を利用します． ただし，t検定を適用するには，下記の条件を満たす必要があります．
 ランダムサンプリングにより標本が抽出されている 母集団の分布が正規分布である 母集団の分散が等質である  上記の条件1，2はこれまでの前提と同じですが，条件3が新しく追加されました． もし，条件3を満たさない場合は，t検定の代わりに，Welchの検定 を利用する必要があります． Welchの検定に関しては割愛します． ここでは，上記の全ての条件を満たしていると仮定して話を進めます．
独立な2群のt検定 -- 独立な2群のt検定それでは，下記の問題について考えていきましょう．" />



  <meta name="twitter:image" content="https://i.gyazo.com/63ddd77d5b31e97fd199a7706d1f3c60.png" />



</head>

    <body>
        <nav class="nav">
  <div class="nav-container">
    <p class="nav-info">Mukai's Lab. at Sugiyama Women's University</p>    
    <a href="/">
    <h2 class="nav-title">
	     <img src="https://mukai-lab.info/favicon/favicon-48x48.png" align="top"/>
	     <span>MLAB</span>
        

<ul id="menu">
  
  
  <li>
    <a href="/">Top</a>
  </li>
  
  
  
  <li>
    <a href="/pages/classes/">授業資料</a>
  </li>
  
  
  
  <li>
    <a href="/pages/tech/">技術メモ</a>
  </li>
  
  
</ul>

<script>
  $(function(){
    $("#menu").slicknav({
      label: "メニュー"
    });
  });
</script>



    </h2>
    </a>
  </div>
</nav>

        

<main>
  <div class="post">
    <div class="post-info">
  <span>written by</span>
  Naoto Mukai
</div>

    <h1 class="post-title">独立な2群のt検定</h1>
<div class="post-line"></div>

    

    <p><a href="https://gyazo.com/63ddd77d5b31e97fd199a7706d1f3c60"><img src="https://i.gyazo.com/63ddd77d5b31e97fd199a7706d1f3c60.png" alt="https://gyazo.com/63ddd77d5b31e97fd199a7706d1f3c60" /></a></p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">平均値差の検定とは -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  平均値差の検定とは
</h1>


<p>これまでは，母集団<script type="math/tex">X</script>と標本<script type="math/tex">x</script>の関係に注目して検定を行いました．
これからは，２つの標本（標本<script type="math/tex">x_1</script>，標本<script type="math/tex">x_2</script>）の関係に注目し，
それぞれの平均値の有意な差があるかどうかを検定します．
２つの標本を検定する場合，下記の条件によって適用する手法が異なります．</p>

<ul>
<li>独立な2群（対応のない2群）</li>
<li>対応のある2群</li>
</ul>

<p><strong>独立な2群（対応のない2群）</strong>とは，ある母集団から２つの標本を抽出したとき，
それぞれの標本に含まれる対象が互いに無関係であることを意味しています．
例えば，下記のように，母集団<script type="math/tex">X</script>から8人の被験者を抽出して，
これをランダムに4人の2群に分けた場合は，「独立な2群」です．</p>

<p style="text-align:center;">
    <script type="math/tex">
        x_1 = \{a,b,c,d\} \\
        x_2 = \{e,f,g,h\}
    </script>
</p>

<p>一方，<strong>対応のある2群</strong> とは，2つの標本に含まれる対象に，何らかの対応関係があることを意味しています．
例えば，下記のように，同じ4人の被験者に対して，2種類の条件下で測定された2群のデータは，「対応のある2群」です．</p>

<p style="text-align:center;">
    <script type="math/tex">
        条件1: x_1 = \{a,b,c,d\} \\
        条件2: x_2 = \{a',b',c',d'\}
    </script>
</p>

<p>今回は，前者の<strong>独立な2群（対応のない2群）</strong>のt検定を解説します．</p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">スクリプトの作成 -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  スクリプトの作成
</h1>


<p>コードを入力し保存するための<strong>スクリプト</strong>を作成しましょう．
[ファイル]-[新しいスクリプト]をクリックし，<strong>Rエディタ</strong>を表示します．
次に，[ファイル]-[保存]をクリックして，スクリプトを保存します．
このとき，ファイル名は<strong>chapter11</strong>としてください．
また，ファイルの保存場所と作業ディレクトリを<strong>デスクトップ</strong>に変更しておきます．</p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">t検定の前提条件 -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  t検定の前提条件
</h1>


<p>独立な2群の平均値差の検定にも<strong>t検定</strong>を利用します．
ただし，t検定を適用するには，下記の条件を満たす必要があります．</p>

<ol>
<li>ランダムサンプリングにより標本が抽出されている</li>
<li>母集団の分布が正規分布である</li>
<li>母集団の分散が等質である</li>
</ol>

<p>上記の条件1，2はこれまでの前提と同じですが，条件3が新しく追加されました．
もし，条件3を満たさない場合は，t検定の代わりに，<strong>Welchの検定</strong> を利用する必要があります．
Welchの検定に関しては割愛します．
ここでは，上記の全ての条件を満たしていると仮定して話を進めます．</p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">独立な2群のt検定 -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  独立な2群のt検定
</h1>


<p>それでは，下記の問題について考えていきましょう．</p>

<div style="border:1px solid black;margin-bottom:5px">

向研究室と見田研究室に所属する学生を対象に情報数学に関するテストを行った．
向研究室に所属する5人の学生<script type="math/tex">x_1</script>と，
見田研究室に所属する5人の学生<script type="math/tex">x_2</script>の得点は下記であった．
向研究室に所属する学生<script type="math/tex">x_1</script>と，
見田研究室の学生<script type="math/tex">x_2</script>の平均値に有意な差はあるか
（どちらも同じ母集団からランダムサンプリングした標本だろうか）．
    
<p style="text-align:center;">
    <script type="math/tex">
        x_1 = \{63,75,72,67,71\} \\
        x_2 = \{70,56,64,56,64\}
    </script>
</p>

</div>

<p>ここでは，2つの標本の平均値の差が問題となるため，
<script type="math/tex">x_1</script>の平均値<script type="math/tex">\mu_1</script>と
<script type="math/tex">x_2</script>の平均値<script type="math/tex">\mu_2</script>の差
<script type="math/tex">\mu_1 - \mu_2</script>の分布を考えます．
この<script type="math/tex">\mu_1 - \mu_2</script>は下記の正規分布に従います．</p>

<p style="text-align:center">
    <script type="math/tex">
    \mu_1 - \mu_2  \sim N( \hat{\mu_1} - \hat{\mu_2}, \hat{\sigma}^2( \frac{1}{n_1} + \frac{1}{n_2}) )
    </script>
</p>

<ul>
<li>母集団の平均<script type="math/tex">\hat{\mu_1}，\hat{\mu_2}</script><br /></li>
<li>母集団の標準偏差<script type="math/tex">\hat{\sigma}</script><br /></li>
<li>標本のサンプル数<script type="math/tex">n_1=5，n_2=5</script><br /></li>
</ul>

<p>ここで，母集団の平均<script type="math/tex">\hat{\mu_1}，\hat{\mu_2}</script>と
母集団の標準偏差<script type="math/tex">\hat{\sigma}</script>が出現します．
先に述べたように「母集団の分散が等質である」ことを前提としているため，
母集団の標準偏差は同じ値を用いることに注意してください．また，一般に母集団の分散は未知であることから，
標本の標準偏差<script type="math/tex">\sigma_1，\sigma_2</script>を含む下記の式を用いて推定します．
この分散の推定値を<strong>プールした分散</strong>と呼びます．</p>

<p style="text-align:center">
    <script type="math/tex">
    \hat{\sigma}^2 = \frac{(n_1 - 1) \sigma_1^2 + (n_2 - 1) \sigma_2^2}{n_1 + n_2 - 2}
    </script>
</p>

<p>上記の分布を標準化すると，検定統計量である<strong>tスコア</strong>は下記の式で表されます．</p>

<p style="text-align:center">
    <script type="math/tex">
    t = \frac{(\mu_1 - \mu_2) - (\hat{\mu_1} - \hat{\mu_2})}{\sqrt{\hat{\sigma} ^2 (\frac{1}{n_1} + \frac{1}{n_2})}}
    </script>
</p>

<p>一般に，帰無仮説は<script type="math/tex">\hat{\mu_1}=\hat{\mu_2}</script>であることから，
<script type="math/tex">\hat{\mu_1}-\hat{\mu_2}=0</script>と仮定することができ，上記の式は下記のようになります．</p>

<p style="text-align:center">
    <script type="math/tex">
    t = \frac{\mu_1 - \mu_2}{\sqrt{\hat{\sigma} ^2 (\frac{1}{n_1} + \frac{1}{n_2})}}
    </script>
</p>

<p>この平均値の差は，自由度が<script type="math/tex">n_1+n_2-2</script>の自由度のt分布に従います．</p>

<p>それでは，検定の手順に従って，上記の問題を解いていきましょう．
まずは，<strong>帰無仮説</strong> と <strong>対立仮説</strong> を立てます．</p>

<ul>
<li>帰無仮説：2つの標本の母平均は等しい <script type="math/tex">\hat{\mu_1} = \hat{\mu_2}</script></li>
<li>対立仮説：2つの標本の母平均は等しくない <script type="math/tex">\hat{\mu_1} \neq \hat{\mu_2}</script></li>
</ul>

<p>次に，<strong>検定統計量</strong> と，<strong>信頼区間(棄却域)</strong> を定めます．
今回は，検定統計量は上記の<strong>tスコア</strong>とし，信頼度には「95%信頼度（5%棄却域）」を用いることにしましょう．</p>

<p>それでは，検定統計量であるtスコアを計算してみましょう．
まずは，標本の平均<script type="math/tex">\mu_1，\mu_2</script>と
標準偏差<script type="math/tex">\sigma_1，\sigma_2</script>を求めます．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">x1 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">c</span>(<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">75</span>,<span style="color:#ae81ff">72</span>,<span style="color:#ae81ff">67</span>,<span style="color:#ae81ff">71</span>)
x2 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">c</span>(<span style="color:#ae81ff">70</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">64</span>)
mu1 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">mean</span>(x1)
mu2 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">mean</span>(x2)
sigma1 <span style="color:#f92672">&lt;-</span> sd(x1)
sigma2 <span style="color:#f92672">&lt;-</span> sd(x2)
    
<span style="color:#f92672">&gt;</span> mu1
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">69.6</span>
<span style="color:#f92672">&gt;</span> mu2
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">62</span>
<span style="color:#f92672">&gt;</span> sigma1
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">4.669047</span>
<span style="color:#f92672">&gt;</span> sigma2
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">6</span></code></pre></div>
<p>次に，母集団の分散の推定値（プールした分散）を求めましょう．
ここで求めた値は <strong>標準偏差</strong><script type="math/tex">\hat{\sigma}</script>ではなく，
<strong>分散</strong><script type="math/tex">\hat{\sigma}^2</script>であることに注意してください．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">n1 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">length</span>(x1)
n2 <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">length</span>(x2)
pvar <span style="color:#f92672">&lt;-</span> ((n1<span style="color:#ae81ff">-1</span>)<span style="color:#f92672">*</span>sigma1<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> (n2<span style="color:#ae81ff">-1</span>)<span style="color:#f92672">*</span>sigma2<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">/</span> (n1 <span style="color:#f92672">+</span> n2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>) 
    
<span style="color:#f92672">&gt;</span> n1
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">5</span>
<span style="color:#f92672">&gt;</span> n2
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">5</span>
<span style="color:#f92672">&gt;</span> pvar
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">28.9</span></code></pre></div>
<p>上記の計算結果を基ににtスコアを求めます．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">t <span style="color:#f92672">&lt;-</span> (mu1 <span style="color:#f92672">-</span> mu2) <span style="color:#f92672">/</span> <span style="color:#66d9ef">sqrt</span>(pvar <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>n1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>n2))
<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">t</span>
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">2.235294</span></code></pre></div>
<p>最後に，自由度<script type="math/tex">n1+n2-2=8</script>のt分布を利用して，帰無仮説が採択か棄却かを調べましょう．
qt関数を用いると，95%信頼度のとき，<strong>t&lt;-2.3</strong>，また，<strong>t&gt;2.3</strong> が棄却域となることが分かります．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> qt(<span style="color:#ae81ff">0.025</span>,<span style="color:#ae81ff">8</span>)
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">-2.306004</span>
<span style="color:#f92672">&gt;</span> qt(<span style="color:#ae81ff">0.975</span>,<span style="color:#ae81ff">8</span>)
[<span style="color:#ae81ff">1</span>] <span style="color:#ae81ff">2.306004</span></code></pre></div>
<p>合わせてt分布をグラフにして確認してみましょう．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> curve(dt(x,<span style="color:#ae81ff">8</span>),<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">3</span>)
<span style="color:#f92672">&gt;</span> abline(v<span style="color:#f92672">=</span>qt(<span style="color:#ae81ff">0.025</span>,<span style="color:#ae81ff">8</span>))
<span style="color:#f92672">&gt;</span> abline(v<span style="color:#f92672">=</span>qt(<span style="color:#ae81ff">0.975</span>,<span style="color:#ae81ff">8</span>))</code></pre></div>
<p><a href="https://gyazo.com/3302a4bf3c494c4c8d12de90b0943e16"><img src="https://i.gyazo.com/3302a4bf3c494c4c8d12de90b0943e16.png" alt="https://gyazo.com/3302a4bf3c494c4c8d12de90b0943e16" /></a></p>

<p>上記の結果から，tスコアの2.24は棄却域に含まれないので，
帰無仮説「2つの標本の母平均は等しい」が採択されます．
これは，向研究室の学生と見田研究室の学生の間には<strong>有意な差がない</strong>ということを意味しています．
これぐらいの差は偶然に起こり得るというわけです．</p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">関数を利用したt検定 -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  関数を利用したt検定
</h1>


<p>上記の検定は<strong>t.test</strong>関数でも可能です．
2つの標本の平均値差を検定するには，比較したい2つの標本を引数として与えるだけです．
このとき，母分散が等質であることを表す<strong>var.equal=TRUE</strong>というオプションも同時に指定します．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> t.test(x1,x2,var.equal<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)

Two Sample <span style="color:#66d9ef">t</span><span style="color:#f92672">-</span>test

data<span style="color:#f92672">:</span>  x1 and x2
t <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.2353</span>, df <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, p<span style="color:#f92672">-</span>value <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.05583</span>
alternative hypothesis<span style="color:#f92672">:</span> true difference <span style="color:#66d9ef">in</span> means is not equal to <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">95</span> percent confidence interval<span style="color:#f92672">:</span>
<span style="color:#ae81ff">-0.2404141</span> <span style="color:#ae81ff">15.4404141</span>
sample estimates<span style="color:#f92672">:</span>
mean of x mean of y 
    <span style="color:#ae81ff">69.6</span>      <span style="color:#ae81ff">62.0</span> </code></pre></div>
<p>tスコアが求めた2.24に一致していることが分かります．
p値が0.05（5%）であることから，ぎりぎり95%信頼度に含まれたことが分かります．
また，母集団の平均値差の信頼区間は<strong>-0.24</strong>から<strong>15.44</strong>となっており，
帰無仮説である<script type="math/tex">\hat{\mu_1} - \hat{\mu_2}=0</script>が含まれていることが分かります．</p>

<!-- # <img style="margin-right:5px;margin-bottom:7px" src="/favicon/favicon-25x25.png">課題 -->

<h1>
  <img class="head-image" src="/logo/logo.png">
  課題
</h1>


<p>見田研究室の学生の得点が{65,55,52,45,51}だったときの<strong>tスコア</strong>を求めなさい．
また，<strong>t検定</strong>を用いて，「95%信頼度（5%棄却域）」のときに，
「帰無仮説：2つの標本の母平均は等しい <script type="math/tex">\hat{\mu_1} = \hat{\mu_2}</script>」は棄却されるか調べ，
そのときの母集団の平均値差の信頼区間も求めなさい．
ソースは<strong>chapter11.R</strong>に記述して提出すること．</p>

<h3>参考書籍</h3>



<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4274067106&linkId=93d694711dbe1bcddf54d4dbceaa6634&bc1=F8F8F8&lt1=_blank&fc1=333333&lc1=0066C0&bg1=F8F8F8&f=ifr"></iframe>
<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=naotoassociat-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4863542011&linkId=92f9b82cf210ae3681f8c607eae4ac8a&bc1=F8F8F8&lt1=_blank&fc1=333333&lc1=0066c0&bg1=F8F8F8&f=ifr"></iframe>





    

    <div class="horizontal">

  
  <div class="fb-share-button" data-href="https://mukai-lab.info/pages/classes/advanced_studies_seminar_2/chapter11/" data-layout="button" data-size="small"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fmukai-lab.info%2Fwww%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">シェア</a></div>
  
  
  <div style="padding: 6px; margin-top:1px">
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-via="nmukai1978" data-hashtags="mlab" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>

  
  
</div>



  </div>

  <div class="pagination">
    <a href="/" class="top" ><span>Top</span></a>
    <a href='javascript:history.back()' class="top" style="margin-left: 30px"><span>Back</span></a>
  </div>

  

  
  <div class="adsense">
    
  </div>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-77390013-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</main>


        <footer>
  <div>
    <span>&copy; <time datetime="2019-06-10 15:38:56.4211242 &#43;0900 JST m=&#43;5.174187101">2019</time> Naoto Mukai. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.</span>
  </div>
</footer>


    </body>
</html>
