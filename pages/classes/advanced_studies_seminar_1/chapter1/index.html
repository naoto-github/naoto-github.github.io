<!DOCTYPE html>
<html lang="ja">
    <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    ニューラルネットワーク | mLAB
  </title>

  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/syntax.css">
  
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="mLAB" />

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kosugi&display=swap" rel="stylesheet">

  
  <script src="https://kit.fontawesome.com/0c97f11cd6.js" crossorigin="anonymous"></script>

  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/jquery.slicknav.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/slicknav.min.css" />

  
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v9.0"></script>  
  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
	     tex2jax: {
	        inlineMath: [['$','$']]
        }
    });
  </script>

  
  

  
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  
  
  

  <meta property="og:title" content="ニューラルネットワーク" />



  <meta property="og:type" content="article" />



  <meta property="og:url" content="https://mukai-lab.info/pages/classes/advanced_studies_seminar_1/chapter1/" />



  <meta property="og:image" content="https://i.gyazo.com/bc94c4754486ae2fb8509f587cab86be.png" />



  <meta property="og:site_name" content="mLAB" />



  <meta property="og:description" content="ニューラルネットワークとは  ニューラルネットワーク（Neural Netowork） とは， 生物の脳を数理的に表現したモデルのことであり， 1943年に外科医であったウォーレン・マカロック（Warren McCulloch）氏と， 数学者であったウォルター・ピッツ（Walter Pitts）氏が考案した形式ニューロンが起源とされています．
1940年代~60年代の第1次AIブームに大きく注目され， 単純パーセプトロン と呼ばれるニューラルネットワークが提案されます． その後，1980年代の第2次AIブームにおいて， ニューラルネットワークの学習アルゴリズムである バックプロパゲーション（誤差逆伝播法） が確立し， 多層パーセプトロン へ発展します．
近年は第3次AIブームであり，ニューラルネットワークをさらに多層化させた ディープラーニング（深層学習） が提案され，画像認識などの分野で高い性能を示しています． 今後もディープラーニングは進化し，自動運転やロボット技術に応用され， 我々の生活を支える必要不可欠な技術になると予想されます． 本授業では，ニューラルネットワークの歴史を追いながら， Google Colaboratory（Colab） で実装することで，その技術を理解することを目標とします． また，ディープラーニングの実装には，Pytorch を採用します．
ニューロン  ニューロン（神経細胞）は，動物の神経を構成する細胞であり，電気的に情報を伝える役割を担っています． 入力部分が樹状突起，伝送路が軸索，出力が軸索末端となっており，他のニューロンからの伝わった刺激（電気パルス）を 変化させて次のニューロンに伝えるという仕組みになっています． 人間の脳は100億から1000億のニューロンが存在すると考えられており， 立体的で複雑な回路網が形成されているそうです． このニューロンの仕組みの数式モデルが 形式ニューロン であり， 後に発展するディープラーニングの基礎となっています．

Jupyter Notebookのインストール  Jupyetr Notebookをインストールします． 過去に人工知能などの授業で既にインストール済みの場合はスキップして構いません． [Python](https://www.python.org)　のインストール・パッケージをダウンロードしましよう． このとき，Pythonのバージョンは**3.x**を選択してください． インストールを始める前に，ファイルをインストールするためのフォルダを作成します． 大学で環境を構築する場合は，**Hドライブ** に，**MyPython** という名前でフォルダを作成してください． それでは，インストーラを実行しましょう． **Customize installation** を選択し， パッケージ管理システムの **pip** が同時にインストールされることを確認してください． [![Image from Gyazo](https://i.gyazo.com/e1fc572f43e771cb3901a76e927a84bd.png)](https://gyazo.com/e1fc572f43e771cb3901a76e927a84bd) [![Image from Gyazo](https://i.gyazo.com/294b8b48f53df91303d1c26bfaf7ada8.png)](https://gyazo.com/294b8b48f53df91303d1c26bfaf7ada8) このとき，インストールするフォルダは，上記で作成した**H:\MyPython**とすることに注意してください． [!" />



  
  
<meta name="twitter:card" content="summary" />

<meta name="twitter:site" content="@nmukai1978" />


  <meta name="twitter:title" content="ニューラルネットワーク" />



  <meta name="twitter:description" content="ニューラルネットワークとは  ニューラルネットワーク（Neural Netowork） とは， 生物の脳を数理的に表現したモデルのことであり， 1943年に外科医であったウォーレン・マカロック（Warren McCulloch）氏と， 数学者であったウォルター・ピッツ（Walter Pitts）氏が考案した形式ニューロンが起源とされています．
1940年代~60年代の第1次AIブームに大きく注目され， 単純パーセプトロン と呼ばれるニューラルネットワークが提案されます． その後，1980年代の第2次AIブームにおいて， ニューラルネットワークの学習アルゴリズムである バックプロパゲーション（誤差逆伝播法） が確立し， 多層パーセプトロン へ発展します．
近年は第3次AIブームであり，ニューラルネットワークをさらに多層化させた ディープラーニング（深層学習） が提案され，画像認識などの分野で高い性能を示しています． 今後もディープラーニングは進化し，自動運転やロボット技術に応用され， 我々の生活を支える必要不可欠な技術になると予想されます． 本授業では，ニューラルネットワークの歴史を追いながら， Google Colaboratory（Colab） で実装することで，その技術を理解することを目標とします． また，ディープラーニングの実装には，Pytorch を採用します．
ニューロン  ニューロン（神経細胞）は，動物の神経を構成する細胞であり，電気的に情報を伝える役割を担っています． 入力部分が樹状突起，伝送路が軸索，出力が軸索末端となっており，他のニューロンからの伝わった刺激（電気パルス）を 変化させて次のニューロンに伝えるという仕組みになっています． 人間の脳は100億から1000億のニューロンが存在すると考えられており， 立体的で複雑な回路網が形成されているそうです． このニューロンの仕組みの数式モデルが 形式ニューロン であり， 後に発展するディープラーニングの基礎となっています．

Jupyter Notebookのインストール  Jupyetr Notebookをインストールします． 過去に人工知能などの授業で既にインストール済みの場合はスキップして構いません． [Python](https://www.python.org)　のインストール・パッケージをダウンロードしましよう． このとき，Pythonのバージョンは**3.x**を選択してください． インストールを始める前に，ファイルをインストールするためのフォルダを作成します． 大学で環境を構築する場合は，**Hドライブ** に，**MyPython** という名前でフォルダを作成してください． それでは，インストーラを実行しましょう． **Customize installation** を選択し， パッケージ管理システムの **pip** が同時にインストールされることを確認してください． [![Image from Gyazo](https://i.gyazo.com/e1fc572f43e771cb3901a76e927a84bd.png)](https://gyazo.com/e1fc572f43e771cb3901a76e927a84bd) [![Image from Gyazo](https://i.gyazo.com/294b8b48f53df91303d1c26bfaf7ada8.png)](https://gyazo.com/294b8b48f53df91303d1c26bfaf7ada8) このとき，インストールするフォルダは，上記で作成した**H:\MyPython**とすることに注意してください． [!" />



  <meta name="twitter:image" content="https://i.gyazo.com/bc94c4754486ae2fb8509f587cab86be.png" />


  
</head>

    <body>
        <nav class="nav">
  <div class="nav-container">
    
    <a href="/">
    <h2 class="nav-title">
      <img src="https://mukai-lab.info/favicon/favicon-48x48.png" align="top"/>
      <span>mLAB</span>
      

<ul id="menu">
  
  
  <li>
    <a href="/">Top</a>
  </li>
  
  
  
  <li>
    <a href="/classes/">Classes</a>
  </li>
  
  
  
  <li>
    <a href="/posts/">Comics</a>
  </li>
  
  
</ul>

<script>
  $(function(){
    $("#menu").slicknav({
      label: "メニュー"
    });
  });
</script>



    </h2>
    </a>
  </div>
</nav>

        

<main>
  <div class="post">
    
    <h1 class="post-title">ニューラルネットワーク</h1>
<div class="post-line"></div>
    
    

    <p><a href="https://gyazo.com/bc94c4754486ae2fb8509f587cab86be"><img src="https://i.gyazo.com/bc94c4754486ae2fb8509f587cab86be.png" alt="Image from Gyazo"></a></p>
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  ニューラルネットワークとは
</h1>

<p><strong>ニューラルネットワーク（Neural Netowork）</strong> とは，
生物の脳を数理的に表現したモデルのことであり，
1943年に外科医であったウォーレン・マカロック（Warren McCulloch）氏と，
数学者であったウォルター・ピッツ（Walter Pitts）氏が考案した形式ニューロンが起源とされています．</p>
<p>1940年代~60年代の第1次AIブームに大きく注目され，
<strong>単純パーセプトロン</strong> と呼ばれるニューラルネットワークが提案されます．
その後，1980年代の第2次AIブームにおいて，
ニューラルネットワークの学習アルゴリズムである <strong>バックプロパゲーション（誤差逆伝播法）</strong> が確立し，
<strong>多層パーセプトロン</strong> へ発展します．</p>
<p>近年は第3次AIブームであり，ニューラルネットワークをさらに多層化させた
<strong>ディープラーニング（深層学習）</strong> が提案され，画像認識などの分野で高い性能を示しています．
今後もディープラーニングは進化し，自動運転やロボット技術に応用され，
我々の生活を支える必要不可欠な技術になると予想されます．
本授業では，ニューラルネットワークの歴史を追いながら，
<a href="https://colab.research.google.com/">Google Colaboratory（Colab）</a> で実装することで，その技術を理解することを目標とします．
また，ディープラーニングの実装には，<a href="https://pytorch.org/">Pytorch</a> を採用します．</p>
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  ニューロン
</h1>

<p>ニューロン（神経細胞）は，動物の神経を構成する細胞であり，電気的に情報を伝える役割を担っています．
入力部分が樹状突起，伝送路が軸索，出力が軸索末端となっており，他のニューロンからの伝わった刺激（電気パルス）を
変化させて次のニューロンに伝えるという仕組みになっています．
人間の脳は100億から1000億のニューロンが存在すると考えられており，
立体的で複雑な回路網が形成されているそうです．
このニューロンの仕組みの数式モデルが <strong>形式ニューロン</strong> であり，
後に発展するディープラーニングの基礎となっています．</p>
<p><a title="Quasar Jarosz at English Wikipedia, CC BY-SA 3.0 &lt;https://creativecommons.org/licenses/by-sa/3.0&gt;, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Neuron_Hand-tuned.svg"><img src="https://i.gyazo.com/eb1d6713ff5b3494c449bf4201586f14.png"></a></p>
<!--
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  Jupyter Notebookのインストール
</h1>


Jupyetr Notebookをインストールします．
過去に人工知能などの授業で既にインストール済みの場合はスキップして構いません．

[Python](https://www.python.org)　のインストール・パッケージをダウンロードしましよう．
このとき，Pythonのバージョンは**3.x**を選択してください．
インストールを始める前に，ファイルをインストールするためのフォルダを作成します．
大学で環境を構築する場合は，**Hドライブ** に，**MyPython** という名前でフォルダを作成してください．

それでは，インストーラを実行しましょう．
**Customize installation** を選択し，
パッケージ管理システムの **pip** が同時にインストールされることを確認してください．

[![Image from Gyazo](https://i.gyazo.com/e1fc572f43e771cb3901a76e927a84bd.png)](https://gyazo.com/e1fc572f43e771cb3901a76e927a84bd)

[![Image from Gyazo](https://i.gyazo.com/294b8b48f53df91303d1c26bfaf7ada8.png)](https://gyazo.com/294b8b48f53df91303d1c26bfaf7ada8)

このとき，インストールするフォルダは，上記で作成した**H:\MyPython**とすることに注意してください．

[![Image from Gyazo](https://i.gyazo.com/d59ad4a8259cd08233c53a23fce576b2.png)](https://gyazo.com/d59ad4a8259cd08233c53a23fce576b2)

インストールが終了すると，下記のダイアログが表示されます．
**Close** を選択して，ダイアログを閉じてください．

[![Image from Gyazo](https://i.gyazo.com/ac9e747d8ee0cdeab324b5a0b1cabd43.png)](https://gyazo.com/ac9e747d8ee0cdeab324b5a0b1cabd43)


次にインストールしたフォルダに移動し，
シフトを押しながら右クリックして **PowerShell** を起動し，下記のコマンドを実行します．
PowerShellは，マイクロソフト製のコマンドラインインターフェイスです．
これで，Jupyter Notebookのインストールは完了です．

```python
> .\Scripts\pip install jupyter
> .\Scripts\pip install "ipython[notebook]"
```

最後に，PowerShellから下記のコマンドを実行し，Jupyter Notebookを起動してください（エクスプローラでダブルクリックでもOK）．

```python
> .\Scripts\jupyter-notebook.exe
```

<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  PyTorchのインストール
</h1>


ディープラーニングのフレームワークとして[Pytorch](https://pytorch.org/) を採用します．
PyTorchはFacebookが中心になり開発されたオープンソースのソフトウェアです．
Pythonで実装が可能であり，下記の特徴があります．

- 強力な **テンソル（多次元配列）演算** が可能
- テンソルを処理する計算グラフの **自動微分** が可能

ここでは，関連するライブラリもまとめてインストールしておきましょう．

- [PyTorch](https://pytorch.org/)（ディープラーニングのフレームワーク）
- [Pillow](http://www.pythonware.com/products/pil/)（画像処理ライブラリ）
- [Matplotlib](https://matplotlib.org/)（グラフ描画ライブラリ）
- [Pandas](https://pandas.pydata.org/)（データ解析ライブラリ）
- [scikit-learn](https://scikit-learn.org/stable/)（機械学習ライブラリ）

シフトを押しながら右クリックして **PowerShell** を起動し，下記のコマンドを実行します．

```python
> .\Scripts\pip install torch torchvision
> .\Scripts\pip install pillow
> .\Scripts\pip install matplotlib
> .\Scripts\pip install pandas
> .\Scripts\pip install scikit-learn
```
-->
<h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  Google Colaboratoryの基本
</h1>

<p>ブラウザでPythonの実装が可能な<a href="https://colab.research.google.com/">Google Colaboratory</a>を利用します．</p>
<h2 id="ノートブックの作成">ノートブックの作成</h2>
<p>Google Colaboratoryにアクセスしたら，ノートブックを新規作成します．
ノートブックを作成したら，ノートブックのタイトル（ファイル名）を設定します．
今回のタイトルは「chapter1.ipynb」としましょう．</p>
<p><a href="https://gyazo.com/fb05f669501c0a323a0605d916be377b"><img src="https://i.gyazo.com/fb05f669501c0a323a0605d916be377b.png" alt="Image from Gyazo"></a></p>
<!-- [![Image from Gyazo](https://i.gyazo.com/314797c278cf43d8296218f013599795.png)](https://gyazo.com/314797c278cf43d8296218f013599795) -->
<h2 id="colabの使い方">Colabの使い方</h2>
<p>Colabでは<strong>コードセル</strong>と呼ばれる入力フィールドにPythonのコードを入力します．
コードセルを増やして，<code>1+2</code>，<code>2*3</code>，<code>print(&quot;Hello World!&quot;)</code>と入力してみましょう．
入力したらコードセルの左端にある「セルを実行」をクリックします．
実行するとコードセルの実行結果である<code>3</code>，<code>6</code>，<code>Hello World!</code>が出力されることが確認できます．
<code>print</code>は文字を出力するためのPythonの命令文です．
このように，適宜，コードセルを増やしながら，Pythonのコードを追加で記述して行きます．</p>
<p><a href="https://gyazo.com/566a9aa4865238998df6ec6337af153d"><img src="https://i.gyazo.com/566a9aa4865238998df6ec6337af153d.png" alt="Image from Gyazo"></a></p>
<h2 id="ライブラリのインストール">ライブラリのインストール</h2>
<p>Google Colaboratoryでは<code>pip</code>コマンドを利用して，ライブラリをインストールすることが可能です．
ここでは，ディープラーニングのライブラリである<a href="https://pytorch.org/">Pytorch</a> をインストールしてみます．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">!pip install torch
!pip install torchvision
</code></pre></div><p><a href="https://gyazo.com/23c454c5390791d97d6a0568069f730e"><img src="https://i.gyazo.com/23c454c5390791d97d6a0568069f730e.png" alt="Image from Gyazo"></a></p>
<h2 id="ライブラリのインポート">ライブラリのインポート</h2>
<p>インストールしたPyTorchをインポートします．
インポートとは，プログラムで該当のライブラリを利用可能な状態にすることです．
下記のコードを入力したら，<strong>Run</strong> ボタンをクリックします（Shift + EnterでもOK）．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> torch
</code></pre></div><h2 id="テンソルの演算">テンソルの演算</h2>
<p>PyTorchでは <strong>テンソル</strong> と呼ばれるデータ型を利用して，ニューラルネットワークの情報伝達を表現します．
ここでは，テンソルの基本的な使い方を学びます．</p>
<h3 id="テンソルの作成">テンソルの作成</h3>
<p><strong>1次元のテンソル（ベクトル）</strong> を作成してみます．
ここで，<code>t</code>は変数と呼ばれ，数値や文字などの値を記憶させるために用います．
また，<code>=</code> は代入を意味し，変数<code>t</code>に作成したテンソルを記憶させることを表しています．
<code>print</code>で変数<code>t</code>の内容を表示します．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>])
<span style="color:#66d9ef">print</span>(t)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>])
</code></pre></div><p><strong>2次元のテンソル（行列）</strong> を作成してみます．
2次元のテンソルは，複数のベクトルを組み合わせて表現します．
ここでは，$(0,1,2)$と$(3,4,5)$の2つのベクトルを組み合わせます．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5<br>
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]])
<span style="color:#66d9ef">print</span>(t)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>],
        [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]])
</code></pre></div><h3 id="テンソルの転置">テンソルの転置</h3>
<p>テンソルの軸を<code>transpose()</code>で入れ替えます（行列の転置）．
引数は入れ替える次元を指定します．
ここでは，<code>t</code>は2次元配列と同じ構造であるため，
0番目（行）と1番目（列）を入れ替えることで転値が成立します．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5<br>
\end{array}
\right)^T =
\left(
\begin{array}{ccc}
0 &amp; 3 \\\<br>
1 &amp; 4 \\\<br>
2 &amp; 5
\end{array}
\right)
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t<span style="color:#f92672">.</span>transpose(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>],
        [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>],
        [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>]])
</code></pre></div><h3 id="テンソルの加算">テンソルの加算</h3>
<p>テンソルとスカラ値の加算を<code>add()</code>で求めます．
テンソルの各成分にスカラ値が加算されます．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5
\end{array}
\right) + 1 = \left(
\begin{array}{ccc}
1 &amp; 2 &amp; 3 \\\<br>
4 &amp; 5 &amp; 6
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">torch<span style="color:#f92672">.</span>add(t, <span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
        [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]])
</code></pre></div><p>テンソル同士の加算も<code>add()</code>で求めることができます．
テンソルの一致する$(i,j)$成分同士が加算されます．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5
\end{array}
\right) +
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5
\end{array}
\right) =
\left(
\begin{array}{ccc}
0 &amp; 2 &amp; 4 \\\<br>
6 &amp; 8 &amp; 10
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">torch<span style="color:#f92672">.</span>add(t, t)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>],
        [<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>]])
</code></pre></div><h3 id="テンソルの乗算">テンソルの乗算</h3>
<p>テンソルとスカラ値の乗算を<code>mul()</code>で求めます．
テンソルの各成分にスカラ値が乗算されます．</p>
<p>$$
\left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5
\end{array}
\right) \times 2 = \left(
\begin{array}{ccc}
0 &amp; 2 &amp; 4 \\\<br>
6 &amp; 8 &amp; 10
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">torch<span style="color:#f92672">.</span>mul(t, <span style="color:#ae81ff">2</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[ <span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">4</span>],
        [ <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>]])
</code></pre></div><p>テンソルとベクトルの内積を<code>mv()</code>で求めます．</p>
<p>$$
t_1 = \left(
\begin{array}{ccc}
0 &amp; 1 &amp; 2 \\\<br>
3 &amp; 4 &amp; 5
\end{array}
\right)\<br>
$$</p>
<p>$$
t_2 = \left(
\begin{array}{ccc}
2 &amp; 2 &amp; 2
\end{array}
\right)\<br>
$$</p>
<p>$$
t_1 \times t_2 = \left(
\begin{array}{ccc}
0 \cdot 2 + 1 \cdot 2 + 2 \cdot 2 &amp; 3 \cdot 2 + 4 \cdot 2 + 5 \cdot 2
\end{array}
\right) = \left(
\begin{array}{ccc}
6 &amp; 24
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t1 <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor([[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]])
t2 <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>])
torch<span style="color:#f92672">.</span>mv(t1, t2)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([ <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">24</span>])
</code></pre></div><p>テンソル同士の内積を<code>mm()</code>で求めます．</p>
<p>$$
t_3 = \left(
\begin{array}{ccc}
1 &amp; 1 \\\<br>
2 &amp; 2 \\\<br>
3 &amp; 3
\end{array}
\right)\<br>
$$</p>
<p>$$
t_1 \times t_3 = \left(
\begin{array}{ccc}
0 \cdot 1 + 1 \cdot 2 + 2 \cdot 3 &amp; 0 \cdot 1 + 1 \cdot 2 + 2 \cdot 3 \\\<br>
3 \cdot 1 + 4 \cdot 2 + 5 \cdot 3 &amp; 3 \cdot 1 + 4 \cdot 2 + 5 \cdot 3
\end{array}
\right) = \left(
\begin{array}{ccc}
8 &amp; 8 \\\<br>
26 &amp; 26
\end{array}
\right)\<br>
$$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t3 <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>]])
torch<span style="color:#f92672">.</span>mm(t1, t3)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
tensor([[ <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">8</span>],
        [<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">26</span>]])
</code></pre></div><h2 id="テンソルの形状">テンソルの形状</h2>
<p>テンソルの形状を<code>shape</code>で確認します．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(t1<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(t2<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(t3<span style="color:#f92672">.</span>shape)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
torch<span style="color:#f92672">.</span>Size([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]) <span style="color:#75715e"># 2次元テンソル（行列）</span>
torch<span style="color:#f92672">.</span>Size([<span style="color:#ae81ff">3</span>]) <span style="color:#75715e"># 1次元テンソル（ベクトル）</span>
torch<span style="color:#f92672">.</span>Size([<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>]) <span style="color:#75715e"># 2次元テンソル（行列）</span>
</code></pre></div><h2 id="テンソルのデータ型">テンソルのデータ型</h2>
<p>テンソルのデータ型を<code>type()</code>で確認します．</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>((torch<span style="color:#f92672">.</span>tensor([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]))<span style="color:#f92672">.</span>type())
<span style="color:#66d9ef">print</span>((torch<span style="color:#f92672">.</span>tensor([<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>]))<span style="color:#f92672">.</span>type())
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#出力</span>
torch<span style="color:#f92672">.</span>LongTensor <span style="color:#75715e">#64ビット符号付き整数</span>
torch<span style="color:#f92672">.</span>FloatTensor <span style="color:#75715e">#32ビット浮動小数点</span>
</code></pre></div><h1 style="padding-left:40px; line-height: 30px; background: url(http://mukai-lab.info/logo/logo.png) no-repeat">
  課題
</h1>

<p>Google Colaboratoryで作成した <strong>chapter1.ipynb</strong> を保存し，
<strong>共有用のリンク</strong> と <strong>ノートブック（.ipynb）</strong> をダウンロードして提出してください．
提出の前に必ず下記の設定を行ってください．</p>
<ul>
<li>ノートブックの設定で「セルの出力を除外する」のチェックを外す</li>
<li>ノートブックの変更内容を保存して固定</li>
<li>共有設定で「学校法人椙山女学園大学」を「閲覧者」に設定</li>
</ul>












    

    
    

    <div class="pagination">
      <a href="/"><span>Top</span></a>
      <a href='javascript:history.back()' style="margin-left: 30px"><span>Back</span></a>
    </div>
    
  </div>

  
  <div>

  <div style="margin-top:20px; border-top: solid 10px #007B50; border-bottom: solid 10px #007B50;">
    <p>
      愛知県名古屋市にある椙山女学園大学 文化情報学部 向研究室の公式サイトです．
      専門は情報科学であり，人工知能やデータベースなどの技術要素を指導しています．
      この公式サイトでは，授業で使用している教材を公開すると共に，
      ベールに包まれた女子大教員のミステリアスな日常を４コマ漫画でお伝えしていきます．
      サイトに関するご意見やご質問は<a href="https://www.facebook.com/nmukai1978">Facebook</a>または<a href="https://twitter.com/nmukai1978">Twitter</a>でお問い合わせください．
    </p>
  </div>  

</div>

  
  
  

    
  

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-77390013-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</main>


        <footer>
  <div>
    <span>&copy; 2016 Naoto Mukai All Rights Reserved.</span> 
  </div>
</footer>


    </body>
</html>
